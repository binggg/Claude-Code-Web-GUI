# Claude Code GUI - 前端开发文档

## 项目概述

Claude Code GUI 是一个基于 Web 的静态前端应用，用于浏览和查看 Claude Code 的会话历史。该应用使用现代浏览器的 File System Access API 来访问本地的 `~/.claude/projects/` 目录。

## 核心功能

### 1. 目录访问
- 使用 `showDirectoryPicker()` API 请求访问 `.claude` 目录
- 兼容性检查：支持 Chrome 86+ 和 Edge 86+
- 错误处理：优雅处理不支持的浏览器和访问被拒绝的情况

### 2. 项目列表
- 自动扫描 `projects` 目录下的所有项目文件夹
- 项目路径解析：将 `-` 分隔的目录名转换为正常路径显示
- 会话计数：显示每个项目包含的会话数量
- 卡片式布局：响应式网格设计

### 3. 会话管理
- 解析 JSONL 格式的会话文件
- 会话排序：按最后修改时间倒序排列
- 会话摘要：显示 summary 或首条消息作为标题
- 会话ID：显示前8位字符的短ID

### 4. 聊天界面
- 类似 Claude 的对话界面设计
- 消息类型区分：用户消息和助手消息使用不同样式
- 工具调用可视化：特殊样式显示工具使用和结果
- 时间戳显示：每条消息显示发送时间
- 自动滚动：打开会话时自动滚动到最新消息

## 技术实现

### HTML 结构
```html
- .container (主容器)
  - .header (顶部标题和访问按钮)
  - #projects-view (项目和会话视图)
    - #projects-container (项目网格)
    - #sessions-container (会话列表)
  - #chat-view (聊天详情视图)
    - .chat-container
      - .chat-header (聊天头部)
      - .chat-messages (消息列表)
```

### CSS 设计特点
- **现代化设计**：使用 CSS Grid 和 Flexbox
- **渐变背景**：品牌色调的线性渐变
- **卡片式布局**：圆角、阴影、悬停效果
- **响应式设计**：移动端适配
- **清晰的视觉层次**：不同元素使用不同的颜色和字体大小

### JavaScript 核心逻辑

#### 1. 目录访问流程
```javascript
requestDirectoryAccess() -> loadProjects() -> renderProjects()
```

#### 2. 会话数据解析
```javascript
// JSONL 解析
const lines = content.trim().split('\n');
for (const line of lines) {
    const record = JSON.parse(line);
    // 处理不同类型的记录
}
```

#### 3. 消息渲染
- 用户消息：右对齐，蓝色背景
- 助手消息：左对齐，灰色背景
- 工具调用：黄色背景的代码块
- 工具结果：绿色背景的代码块

## 浏览器兼容性

### 支持的浏览器
- Chrome 86+
- Edge 86+
- Safari（部分支持，需要用户手动启用实验性功能）

### File System Access API 特性
- 需要用户主动授权
- 只能访问用户明确选择的目录
- 安全沙箱：无法访问系统敏感目录

## 使用说明

1. **打开应用**：在支持的浏览器中打开 `index.html`
2. **选择目录**：点击"选择 .claude 目录"按钮
3. **浏览项目**：在弹出的目录选择器中找到并选择 `.claude` 目录
4. **查看会话**：点击项目卡片查看该项目的所有会话
5. **查看详情**：点击具体会话查看完整的对话记录

## 错误处理

- **浏览器不支持**：显示友好提示信息
- **目录访问失败**：捕获异常并显示错误信息
- **文件解析错误**：忽略损坏的 JSON 行，继续处理其他数据
- **网络中断**：本地文件访问，无网络依赖

## 性能优化

- **懒加载**：只在需要时读取会话文件内容
- **内存管理**：及时清理不需要的文件句柄
- **UI 响应**：使用 loading 状态提升用户体验
- **批量处理**：异步处理多个文件以避免阻塞 UI

## 后续扩展计划

1. **搜索功能**：在会话中搜索特定内容
2. **导出功能**：将会话导出为 Markdown 或 PDF
3. **主题切换**：支持深色模式
4. **会话统计**：显示使用时长、消息数量等统计信息
5. **多语言支持**：国际化界面文本